# Print the table of results
print(results)
View(results)
208-23
208-37
208 - 81
temp1 = 38
temp2= 32
instr1='detect
instr1='detect'
instr2='detect'
df1 <- subset(df, baseline == temp1 & instruction == instr1)
df2 <- subset(df, baseline == temp2 & instruction == instr2)
# Extract PHS response vector
phs_df1 <- df1$phs_01
phs_df2 <- df2$phs_01
# Compute contingency table counts
yy <- sum(phs_df1 == 1 & phs_df2 == 1)
yn <- sum(phs_df1 == 1 & phs_df2 == 0)
ny <- sum(phs_df1 == 0 & phs_df2 == 1)
nn <- sum(phs_df1 == 0 & phs_df2 == 0)
phs_comparison <- matrix(c(yy, yn, ny, nn),
nrow = 2,
dimnames = list("temp1" = c("phs_yes", "phs_no"),
"temp2" = c("phs_yes", "phs_no")))
View(phs_comparison)
if (!require("pacman")) install.packages("pacman")
pacman::p_load(boot, broom, broom.mixed, brms, car, caret, corrplot, DHARMa, gamlss,
ggeffects, gghalves, ggpol, ggpubr, glmmTMB, groupdata2, lme4, lmerTest,
modelsummary, MuMIn, polycor, RColorBrewer, rcompanion, reshape2, Rmisc,
rsample, rstatix, simr, tibble, tidyverse, wesanderson, patchwork,
cowplot, flextable
)
# functions and data
source(file.path("scripts","utility.R"))
source(file.path("scripts","plots.R"))
source(file.path("scripts","supplementary.R"))
source(file.path("scripts","models.R"))
stats = statistics(rerun = F)
#save.image("~/tgi-spinal/Workspace/stats.RData")
list2env(stats, envir=environment())
# now plot the difference
plot = data = vas_h1_diff %>% ggplot(aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5, size = 1.7) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .15, size = .75, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none',
axis.text = element_text(size = 9),
axis.title = element_text(size = 11),
strip.text = element_text(size = 10),
title = element_text(size=10)) +
coord_cartesian(ylim = c(-30,30))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
plot1(include_zero = F)
source(file.path("scripts","plots.R"))
plot1(include_zero = F)
# now plot the difference
plot = data = vas_h1_diff %>% ggplot(aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5, size = 1.7) +
geom_line(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .7) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .15, size = .75, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none',
axis.text = element_text(size = 9),
axis.title = element_text(size = 11),
strip.text = element_text(size = 10),
title = element_text(size=10)) +
coord_cartesian(ylim = c(-40,40))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
plot1(include_zero = F)
source(file.path("scripts","plots.R"))
plot1(include_zero = F)
source(file.path("scripts","plots.R"))
plot1(include_zero = F)
plot1(include_zero = F)
#plot1(include_zero = T)
source(file.path("scripts","plots.R"))
plot1(include_zero = F)
plot2_3(include_zero = F)[[1]]
plot2_3(include_zero = F)[[2]]
## figures with thresholds and TGI temperatures
exp1_temps <- read.csv(file.path("data", 'STGI_exp2_compiled-data.csv'))
getwd
getwd()
setwd('/Users/au706616/Documents/Git/tgi-spinal')
getwd()
## figures with thresholds and TGI temperatures
exp1_temps <- read.csv(file.path("data", 'STGI_exp1_temperatures.csv'))
rm(list=ls())
## figures with thresholds and TGI temperatures
exp1_temps <- read.csv(file.path("data", 'STGI_exp1_temperatures.csv'))
View(exp1_temps)
# modify data
exp1_temps <- exp1_temps %>%
mutate(EXP = 'experiment1')
# modify data
exp1_temps <- exp1_temps %>%
mutate(EXP = 'exp1')
# modify data
exp1_temps <- exp1_temps %>%
mutate(EXP = 'exp1') %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH')
exp2_temps <- exp2_temps %>%
mutate(EXP = 'exp2')
exp2_temps <- read.csv(file.path("data", 'STGI_exp2_temperatures.csv'))
exp2_temps <- exp2_temps %>%
mutate(EXP = 'exp2')
## figures with thresholds and TGI temperatures
exp1_temps <- read.csv(file.path("data", 'STGI_exp1_temperatures.csv'))
exp2_temps <- read.csv(file.path("data", 'STGI_exp2_temperatures.csv'))
# modify data
exp1_temps <- exp1_temps %>%
mutate(EXP = 'exp1')
exp2_temps <- exp2_temps %>%
mutate(EXP = 'exp2')
# combine both
temps <- rbind(exp1_temps, exp2_temps)
View(temps)
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH')
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
recode_factor(TEMP, CPT = 'cold', HPT = 'warm') %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
mutate(TEMP = fct_recode(TEMP, 'CPT' = 'cold', 'HPT' = 'warm') %>%
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'CPT' = 'cold', 'HPT' = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(fct_recode(TEMP, 'CPT' = 'cold', 'HPT' = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode('CPT' = 'cold', 'HPT' = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(CPT = 'cold', HPT = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
# combine both
temps <- rbind(exp1_temps, exp2_temps)
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(CPT = 'cold', HPT = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
# combine both
temps <- rbind(exp1_temps, exp2_temps)
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, CPT = 'cold', HPT = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
# combine both
temps <- rbind(exp1_temps, exp2_temps)
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'CPT' = 'cold', 'HPT' = 'warm')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'warm' = 'HPT')) %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
# combine both
temps <- rbind(exp1_temps, exp2_temps)
temps <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'warm' = 'HPT'))
temps <- temps %>%
pivot_longer(cols = c(CTGI, WTGI, names_to = 'TEMP', values_to = 'TGI'))
temps <- temps %>%
pivot_longer(cols = c(CTGI, WTGI), names_to = 'TEMP', values_to = 'TGI')
temps <- temps %>%
pivot_longer(cols = c(CTGI, WTGI), names_to = 'T', values_to = 'TGI')
# combine both
temps <- rbind(exp1_temps, exp2_temps)
temps1 <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'warm' = 'HPT'))
temps2 <- temps %>%
pivot_longer(cols = c(CTGI, WTGI), names_to = 'TEMP', values_to = 'TGI')
data = '12345678'
data[-length(data)] <- paste0(data[-length(data)], '10')
data
paste0(data[-length(data)], '10')
data[-length(data)]
data[-length(data)-4]
class(data)
data <- as.string(data)
substr(data, 1, 3)
length(data)
# combine both
temps <- rbind(exp1_temps, exp2_temps)
temps1 <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'warm' = 'HPT'))
temps2 <- temps %>%
pivot_longer(cols = c(CTGI, WTGI), names_to = 'TEMP', values_to = 'TGI') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CTGI', 'warm' = 'WTGI'))
View(temps1)
temps1 <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'warm' = 'HPT')) %>%
select(-c(CTGI, WTGI))
temps2 <- temps %>%
pivot_longer(cols = c(CTGI, WTGI), names_to = 'TEMP', values_to = 'TGI') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CTGI', 'warm' = 'WTGI')) %>%
select(-c(CPT,HPT))
thr_exp1 <- ggplot(data = temps %>%
filter(EXP == 'exp1')) +
geom_point(TEMP. THRESH)
thresh <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'warm' = 'HPT')) %>%
select(-c(CTGI, WTGI))
tgi <- temps %>%
pivot_longer(cols = c(CTGI, WTGI), names_to = 'TEMP', values_to = 'TGI') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CTGI', 'warm' = 'WTGI')) %>%
select(-c(CPT,HPT))
thr_exp1 <- ggplot(data = thresh %>%
filter(EXP == 'exp1')) +
geom_point(TEMP. THRESH)
thr_exp1 <- ggplot(data = thresh %>%
filter(EXP == 'exp1')) +
geom_point(aes(TEMP, THRESH))
thr_exp1
thr_exp1 <- ggplot(data = thresh %>%
filter(EXP == 'exp1')) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2))
thr_exp1
thresh <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
mutate(TEMP = fct_recode(TEMP, 'cold' = 'CPT', 'heat' = 'HPT')) %>%
select(-c(CTGI, WTGI))
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
facet_wrap(~EXP)
thr_exp1
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
facet_wrap(~EXP) +
theme_classic
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(EXP, THRESH, group = ID), position = position_dodge(.2)) +
facet_wrap(~TEMP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(EXP, THRESH, group = ID), position = position_dodge(.2)) +
geom_line(aes(EXP, THRESH, group = ID), position = position_dodge(.2)) +
facet_wrap(~TEMP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
alpha = .32) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2)) +
geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
alpha = .2) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 21) +
geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
alpha = .2) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 21, alpha = .8) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
blue <- brewer.pal(8, "Blues")
grey <- brewer.pal(8, "Greys")
purp <- brewer.pal(8, "Purples")
oran <- brewer.pal(8, "Oranges")
gren <- brewer.pal(8, "Greens")
blue <- brewer.pal(8, "Blues")
grey <- brewer.pal(8, "Greys")
purp <- brewer.pal(8, "Purples")
oran <- brewer.pal(8, "Oranges")
gren <- brewer.pal(8, "Greens")
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[4], oran[4]))
blue <- brewer.pal(8, "Blues")
grey <- brewer.pal(8, "Greys")
purp <- brewer.pal(8, "Purples")
oran <- brewer.pal(8, "Oranges")
gren <- brewer.pal(8, "Greens")
thr_exp1
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 1.5) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
thresh <- temps %>%
pivot_longer(cols = c(CPT,HPT), names_to = 'TEMP', values_to = 'THRESH') %>%
select(-c(CTGI, WTGI))
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 1.5) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'Pain thresholds') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic()
thr_exp1
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 1.5) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'Pain thresholds') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
thr_exp1
thr_exp1 <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'Pain thresholds') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot <- ggplot(data = tgi, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
geom_line(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'TGI temperatures') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot
tgi_plot <- ggplot(data = tgi, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
geom_line(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
alpha = .3, colour = 'grey50', size = .8) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'TGI temperatures') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot
tgi_plot <- ggplot(data = tgi, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
geom_line(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
alpha = .3, colour = 'grey80', size = .8) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'TGI temperatures') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot
tgi_plot <- ggplot(data = tgi, aes(color = TEMP, fill = TEMP)) +
geom_line(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
alpha = .3, colour = 'grey80', size = .8) +
geom_point(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'TGI temperatures') +
ylim(5,45) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot
thr_plot <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'Pain thresholds') +
ylim(0,50) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot <- ggplot(data = tgi, aes(color = TEMP, fill = TEMP)) +
geom_line(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
alpha = .3, colour = 'grey80', size = .8) +
geom_point(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'TGI temperatures') +
ylim(0,50) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
tgi_plot
out_plot <- ggarrange(thr_plot, tgi_plot)
out_plot
tgi_plot <- ggplot(data = tgi, aes(color = TEMP, fill = TEMP)) +
geom_line(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
alpha = .3, colour = 'grey75', size = .8) +
geom_point(aes(TEMP, TGI, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
scale_color_manual(values = c(blue[5], oran[5])) +
labs(x = NULL, y = '', title = 'TGI temperatures') +
ylim(0,50) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
out_plot <- ggarrange(thr_plot, tgi_plot)
# functions and data
source(file.path("scripts","utility.R"))
source(file.path("scripts","plots.R"))
source(file.path("scripts","supplementary.R"))
source(file.path("scripts","models.R"))
sPlot1(include_zero = F)
thr_plot <- ggplot(data = thresh, aes(color = TEMP, fill = TEMP)) +
geom_point(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
shape = 20, alpha = .8, size = 2) +
#geom_line(aes(TEMP, THRESH, group = ID), position = position_dodge(.2),
#          alpha = .2) +
scale_color_manual(values = c(blue[8], red[8])) +
labs(x = NULL, y = 'Temperature (ºC)', title = 'Pain thresholds') +
ylim(0,50) +
facet_wrap(~EXP) +
theme_classic() +
theme(legend.position = 'none')
source(file.path("scripts","supplementary.R"))
source(file.path("scripts","supplementary.R"))
sPlot1(include_zero = F)
source(file.path("scripts","supplementary.R"))
sPlot1(include_zero = F)
# functions and data
source(file.path("scripts","utility.R"))
source(file.path("scripts","plots.R"))
source(file.path("scripts","supplementary.R"))
source(file.path("scripts","models.R"))
# Figure2
f2_plot(include_zero = T)
source(file.path("scripts","plots.R"))
# Figure2
f2_plot(include_zero = T)
f3_plot(include_zero = F)
f45_plot(include_zero = F)[[1]]
f45_plot(include_zero = F)[[2]]
