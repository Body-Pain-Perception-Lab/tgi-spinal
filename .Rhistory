# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_warm_exp1)
# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
(1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_warm_exp1)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% ggplot(aes(x = manipulation, y = beta))+geom_smooth()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% ggplot(aes(x = manipulation, y = beta))+geom_point()
df_long_exp1 %>% filter(quality == 'warm', beta == 0) %>% ggplot(aes(x = manipulation, y = beta))+geom_point()
experiment1 = prep_data(file.path("data", 'STGI_exp1_compiled-data.csv'))
vas_h1_diff_exp1 = experiment1$vas_h1_diff
h1_diff_sum_exp1 = experiment1$h1_diff_sum
title = "Reference: Cold Thermode"
# now plot the difference
plot = ggplot(data = vas_h1_diff, aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .1, size = .7, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none')+coord_cartesian(ylim = c(-30,30))+scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
plot
# now plot the difference
plot = ggplot(data = vas_h1_diff, aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .1, size = .7, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none')+coord_cartesian(ylim = c(-30,30))+scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
vas_h1_diff = vas_h1_diff_exp1
h1_diff_sum = h1_diff_sum
h1_diff_sum = h1_diff_sum_exp1
# now plot the difference
plot = ggplot(data = vas_h1_diff, aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .1, size = .7, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none')+coord_cartesian(ylim = c(-30,30))+scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
plot
# now plot the difference
plot = data = vas_h1_diff %>% ggplot(aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .1, size = .7, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none')+coord_cartesian(ylim = c(-30,30))+scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
plot
# now plot the difference
plot = data = vas_h1_diff %>% filter(beta != 0) %>% ggplot(aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .1, size = .7, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none')+coord_cartesian(ylim = c(-30,30))+scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
vas_h1_diff
vas_h1_diff
# now plot the difference
plot = data = vas_h1_diff %>% ggplot(aes(colour = quality)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_point(aes(manipulation, difference, group = ID), position = position_dodge(.2),
alpha = .5) +
geom_point(data = h1_diff_sum, aes(manipulation, difference), colour = 'grey15',
fill = 'grey15',
shape = 21, size = 3) +
geom_errorbar(data = h1_diff_sum, aes(manipulation, ymin = difference-ci,
ymax = difference+ci),
width = .1, size = .7, colour = 'grey15') +
facet_wrap(~quality) +
scale_colour_manual(values = c(blue[5], oran[5], purp[5])) +
labs(title = paste0(title),
y = 'Within - Across VAS Ratings', x = NULL) +
theme_classic() +
theme(legend.position = 'none')+coord_cartesian(ylim = c(-30,30))+scale_y_continuous(breaks = scales::pretty_breaks(n = 5))
plot
knitr::opts_chunk$set(echo = TRUE)
## Loading libraries
# check for pacman package and install if not found
if (!require("pacman")) install.packages("pacman")
pacman::p_load(boot, broom, broom.mixed, brms, car, caret, corrplot, DHARMa, gamlss,
ggeffects, gghalves, ggpol, ggpubr, glmmTMB, groupdata2, lme4, lmerTest,
modelsummary, MuMIn, polycor, RColorBrewer, rcompanion, reshape2, Rmisc,
rsample, rstatix, simr, tibble, tidyverse, wesanderson
)
vas_meds
vas_h1
knitr::opts_chunk$set(echo = TRUE)
## Loading libraries
# check for pacman package and install if not found
if (!require("pacman")) install.packages("pacman")
pacman::p_load(boot, broom, broom.mixed, brms, car, caret, corrplot, DHARMa, gamlss,
ggeffects, gghalves, ggpol, ggpubr, glmmTMB, groupdata2, lme4, lmerTest,
modelsummary, MuMIn, polycor, RColorBrewer, rcompanion, reshape2, Rmisc,
rsample, rstatix, simr, tibble, tidyverse, wesanderson
)
# experiment 1 file
dat_file <- file.path("data", 'STGI_exp1_compiled-data.csv')
# load all data file
if (file.exists(dat_file)){
df_res <- read.csv(dat_file)
} else {
print('Data file does not exist, check data is in current directory.
If not, run tgi-compiler.Rmd')
}
model_warm_exp1
summary(model_warm_exp1)
# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation * cold_probe,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_warm_exp1)
# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID) %>% summarize(mean = mean(beta))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation) %>% summarize(mean = mean(beta))+ggplot(aes(x = manipulation, y = mean))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))+geom_point()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))+geom_point()+theme_classic()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))+geom_point(col = condition)+theme_classic()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))+geom_point(col = condition)+theme_classic()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))+geom_point(col = condition)+theme_classic()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot(notch = T)
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation * cold_probe,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_warm_exp1)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) pivot_wider(names_from = condition, values_from = beta)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% pivot_wider(names_from = condition, values_from = beta)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% pivot_wider(names_from = condition, values_from = beta)%>%
mutate(difference = within - across)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% pivot_wider(names_from = condition, values_from = beta)%>%
mutate(difference = within - across) %>% summarize(mean = mean(difference))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% pivot_wider(names_from = condition, values_from = beta)%>%
mutate(difference = within - across) %>% summarize(mean = mean(difference, na.rm = T))
df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = condition, values_from = beta) %>% group_by(ID, manipulation,condition)
df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = condition, values_from = beta)
df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = condition, values_from = beta) %>%   mutate(difference = within - across)
df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = condition, values_from = beta) %>%   mutate(difference = within - across) %>% .$difference
df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = condition, values_from = VAS) %>%   mutate(difference = within - across)
aa = df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = condition, values_from = VAS) %>%   mutate(difference = within - across)
View(aa)
aa = df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = c(condition,ID), values_from = VAS) %>%   mutate(difference = within - across)
aa = df_long_exp1 %>% filter(quality == 'warm', beta != 0)%>% pivot_wider(names_from = c(condition,ID), values_from = VAS)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_boxplot()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge())
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.2))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))
knitr::opts_chunk$set(echo = TRUE)
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
meaneffects
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-se))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), position = position = position_dodge(width = 0.3))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), position = position_dodge(width = 0.3))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), position = position_dodge(width = 0.3), size = 2)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), position = position_dodge(width = 0.3), size = 1.5)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), position = position_dodge(width = 0.3), size = 1)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), size = 1)
?geom_pointrange()
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean+se, ymax = mean-2*se), size = 1, linewidth = 1.5)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 1, linewidth = 1.5)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))
meaneffects = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()
meaneffects = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2
)
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)
meaneffects = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)
meaneffects = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("Without 0")
meaneffects = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("With 0")
plot2 = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("Without 0")
meaneffects = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot1 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("With 0")
plot1+plot2
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot2 = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("Without 0")
meaneffects2 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot1 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects2, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects2,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("With 0")
plot1+plot2
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot2 = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("Without 0")
meaneffects2 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot1 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects2, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects2,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("With 0")
plot1+plot2
meaneffects = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot2 = df_long_exp1 %>% filter(quality == 'warm', beta != 0) %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("Without 0")
meaneffects2 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(manipulation,condition) %>% summarize(mean = mean(beta), se = sd(beta)/sqrt(n()))
plot1 = df_long_exp1 %>% filter(quality == 'warm') %>% group_by(ID, manipulation,condition) %>% summarize(mean = mean(beta)) %>% ggplot(aes(x = manipulation, y = mean, col = condition))+geom_point(position = position_dodge(width = 0.3))+
geom_pointrange(data = meaneffects2, aes(x = manipulation, col = condition, y = mean, ymin = mean-2*se, ymax = mean+2*se), size = 0.5, linewidth = 1.5,position = position_dodge(width = 0.5))+theme_classic()+
geom_line(
data = meaneffects2,
aes(x = manipulation, y = mean, group = condition, col = condition),
position = position_dodge(width = 0.5),
size = 1.2)+ggtitle("With 0")
plot1+plot2
experiment1 = prep_data(file.path("data", 'STGI_exp1_compiled-data.csv'))
experiment2 = prep_data(file.path("data", 'STGI_exp2_compiled-data.csv'))
df_long_exp1 = experiment1$df_long %>% mutate(cold_probe = as.factor(cold_probe), manipulation = as.factor(manipulation))
df_long_exp2 = experiment2$df_long %>% mutate(cold_probe = as.factor(cold_probe), manipulation = as.factor(manipulation))
## Define constrats such that we both get within / across (i.e. distal & proximal vs rostral & caudual)
levels(df_long_exp1$cold_probe)
# "caudal"   "distal"   "proximal" "rostral"
#within - across
within_across = c(-1/2,1/2,1/2,-1/2)
#caudal - rostral
caudal_rostral = c(1,0,0,-1)
#distral - proximal
distal_proximal = c(0,1,-1,0)
#define the matrix
cold = rbind(1/4,within_across,caudal_rostral,distal_proximal)
#solve it
cold = solve(cold)
#remove the constant
cold = cold[,-1]
######### Exp 1 (Hypothesis 1)
## hypothsis 1
# Cold
model_cold_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe + trial_n +
(1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp1 %>% filter(quality == 'cold'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_cold_exp1)
# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation * cold_probe,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_warm_exp1)
# Warm
model_warm_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp1 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_warm_exp1)
# Burn
#The burning hypothesis is only for participants that experience burning TGI
#(aka are responders)
# First, remove non-responders
df_resp_exp1 <- df_long_exp1 %>%
filter(responder == 1)
# check n
length(unique(df_resp_exp1$ID))
model_burn_exp1 = glmmTMB::glmmTMB(beta ~ manipulation * condition * cold_cond +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_resp_exp1 %>% filter(quality == 'burn'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_burn_exp1)
# Cold
model_cold_exp2 = glmmTMB::glmmTMB(beta ~ manipulation*cold_probe  + trial_n +
(1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp2 %>% filter(quality == 'cold'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_cold_exp2)
# Warm
model_warm_exp2 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp2 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold))
summary(model_warm_exp2)
# Warm
model_warm_exp2 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_long_exp2 %>% filter(quality == 'warm'),
na.action = na.omit,
contrasts=list(cold_probe = cold))
summary(model_warm_exp2)
# Burn
#The burning hypothesis is only for participants that experience burning TGI
#(aka are responders)
# First, remove non-responders
df_resp_exp2 <- df_long_exp2 %>%
filter(responder == 1)
# check n
length(unique(df_resp_exp2$ID))
model_burn_exp2 = glmmTMB::glmmTMB(beta ~ manipulation * cold_probe +
trial_n + (1|ID) + (1|order),
family = glmmTMB::beta_family(),
ziformula = ~1+manipulation,
data = df_resp_exp2 %>% filter(quality == 'burn'),
na.action = na.omit,
contrasts=list(cold_probe = cold)
)
summary(model_burn_exp2)
